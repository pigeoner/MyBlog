{%extends "base.html"%}
{% load static %}
{% block head %}
<style>
    body{
        background-image: url("/static/blog/img/dm-bg8.gif");
        background-repeat: repeat;
        background-attachment: fixed;
        background-size: auto;
        background-position: center;
    }
    #title{
        margin-bottom: 30px;
    }
</style>
{% endblock %}

{% block content %}
    <input type="text" id="title">
    {{ form.media }}
    {% for field in form %}
         {{ field }} 
    {% endfor %}
    <select name="tags" id="tags">
        {% for op in tags %}
            <option value="{{op}}">{{op}}</option>
        {% endfor %}
    </select>
    <select name="category" id="category">
        {% for op in category %}
            <option value="{{op}}">{{op}}</option>
        {% endfor %}
    </select>
    <button id='submit'>submit</button>
{% endblock %}

{%block script%}
<script>
    $('#title').css({'width': '90%'});
    $('#submit').click(
        ()=>{
            $.ajaxSetup({
                data:{csrfmiddlewaretoken:'{{ csrf_token }}'},
            });
            $.ajax({
                url:"{% url 'blog:add' %}",
                type:'POST',
                dataType: "json",
                data: { 
                    "body": $('#id_content').val(),
                    "title": $('#title').val(),
                    "tags": $('#tags').val(),
                    "category": $('#category').val(),
                },
                success:function(res){
                    alert('ok');
                },
                error: function(ree) { 
                    console.error(ree.status,ree.responseText);
            }
        })
    });
</script>
{%endblock%}